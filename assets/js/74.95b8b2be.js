(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{609:function(t,s,a){t.exports=a.p+"assets/img/travis_setting.7e3f483b.jpg"},610:function(t,s,a){t.exports=a.p+"assets/img/github_tokens.5484a7bf.jpg"},730:function(t,s,a){"use strict";a.r(s);var n=a(27),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"通过travis自动部署vue项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#通过travis自动部署vue项目"}},[t._v("#")]),t._v(" 通过Travis自动部署Vue项目")]),t._v(" "),n("h2",{attrs:{id:"travis-是什么"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#travis-是什么"}},[t._v("#")]),t._v(" travis 是什么")]),t._v(" "),n("blockquote",[n("p",[t._v("Travis CI 提供的是持续集成服务（Continuous Integration，简称 CI）。它绑定 Github 上面的项目，只要有新的代码，就会自动抓取。然后，提供一个运行环境，执行测试，完成构建，还能部署到服务器。")])]),t._v(" "),n("p",[t._v('持续集成指的是只要代码有变更，就自动运行构建和测试，反馈运行结果。确保符合预期以后，再将新代码"集成"到主干。')]),t._v(" "),n("p",[t._v("持续集成的好处在于，每次代码的小幅变更，就能看到运行结果，从而不断累积小的变更，而不是在开发周期结束时，一下子合并一大块代码。")]),t._v(" "),n("h2",{attrs:{id:"名词解释"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#名词解释"}},[t._v("#")]),t._v(" "),n("strong",[t._v("名词解释")])]),t._v(" "),n("ul",[n("li",[n("p",[t._v("持续集成(每次提交代码的时候，都进行构建、测试等)")])]),t._v(" "),n("li",[n("p",[t._v("持续交付(代码通过测试后，将其部署到测试环境)")])]),t._v(" "),n("li",[n("p",[t._v("持续部署(代码通过测试后，将其部署到生产环境)")])])]),t._v(" "),n("h2",{attrs:{id:"为什么需要自动部署"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么需要自动部署"}},[t._v("#")]),t._v(" 为什么需要自动部署")]),t._v(" "),n("p",[t._v("比如我们现在开发一个组件库，里面涉及一个文档(静态网页)")]),t._v(" "),n("ol",[n("li",[n("code",[t._v("npm run docs:build")])]),t._v(" "),n("li",[t._v("推送至gh-page分支 "),n("code",[t._v("add commit push")])])]),t._v(" "),n("p",[n("em",[n("strong",[t._v("这几步完全可以使用自动化部署，今天采用git仓库和Travis CI实现自动化部署，把文章发布的工作交给Travis CI去完成，我们只专心创作就行。")])])]),t._v(" "),n("h2",{attrs:{id:"具体流程大纲"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#具体流程大纲"}},[t._v("#")]),t._v(" 具体流程大纲")]),t._v(" "),n("ul",[n("li",[t._v("脚手架一个项目并GitHub托管(自动部署貌似现在支持码云⭐)")]),t._v(" "),n("li",[t._v("上"),n("a",{attrs:{href:"https://travis-ci.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Travis"),n("OutboundLink")],1),t._v("官网配置仓库")]),t._v(" "),n("li",[t._v("生成"),n("a",{attrs:{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub令牌Access Token"),n("OutboundLink")],1)]),t._v(" "),n("li",[t._v("在Travis配置token")]),t._v(" "),n("li",[t._v("Vue项目根目录创建并配置.travis.yml文件")]),t._v(" "),n("li",[t._v("推送触发编译生成分支gh-pages")]),t._v(" "),n("li",[t._v("仓库开启分支GitHub page功能,分支选址gh-pages")]),t._v(" "),n("li",[t._v("push到仓库就会触发Travis CI 的自动构建")])]),t._v(" "),n("h2",{attrs:{id:"travis配置token"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#travis配置token"}},[t._v("#")]),t._v(" Travis配置token")]),t._v(" "),n("p",[n("img",{attrs:{src:a(609),alt:"github生成key"}})]),t._v(" "),n("h2",{attrs:{id:"github生成key"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#github生成key"}},[t._v("#")]),t._v(" github生成key")]),t._v(" "),n("ul",[n("li",[n("em",[n("strong",[t._v("只需要勾上repo")])]),t._v(" 其他随意")]),t._v(" "),n("li",[n("em",[n("strong",[t._v("生成后第一时间复制key，页面刷新就没了")])])])]),t._v(" "),n("p",[n("img",{attrs:{src:a(610),alt:"github生成key"}})]),t._v(" "),n("h2",{attrs:{id:"创建-travis-yml配置文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建-travis-yml配置文件"}},[t._v("#")]),t._v(" 创建.travis.yml配置文件")]),t._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定语言及版本")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("language")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" node_js\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("node_js")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10"')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装项目包")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("install")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm install\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm add node"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("sass\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 运行脚本")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("script")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm run docs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("build\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 自动化编译推送GitHub")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("deploy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" pages\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("skip-cleanup")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("github-token")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" $travis_ci "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# travis setting 中的环境变量 GITHUB_TOKEN")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("local-dir")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./web/my"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("components"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("librarys "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 根据情况自定义到静态文件输出目录")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("target-branch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" gh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("pages "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 构建后的静态资源提交到这个分支")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("verbose")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branch")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 触发自动化部署的分支")]),t._v("\n\n\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br")])]),n("h2",{attrs:{id:"记录一点心得-踩坑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#记录一点心得-踩坑"}},[t._v("#")]),t._v(" 记录一点心得(踩坑)")]),t._v(" "),n("blockquote",[n("p",[t._v("一不注意就能折腾半天")])]),t._v(" "),n("p",[t._v(".travis.yml文件配置注意点")]),t._v(" "),n("ul",[n("li",[n("em",[n("strong",[t._v("一开始用了yarn 报了一些依赖包下载不了的错，如果遇到这种情况更换npm")])])]),t._v(" "),n("li",[n("em",[n("strong",[t._v("在install完之后加一句(如果项目依赖node-sass)")])]),t._v(" "),n("code",[t._v("npm add node-sass")])])]),t._v(" "),n("p",[t._v("token令牌在GitHub个人设置下的")]),t._v(" "),n("ul",[n("li",[t._v("Developer settings")]),t._v(" "),n("li",[t._v("Personal access tokens")]),t._v(" "),n("li",[t._v("new token")]),t._v(" "),n("li",[t._v("随便命名及勾选repo")]),t._v(" "),n("li",[n("em",[n("strong",[t._v("记得保存下来(页面刷新就没了)")])])])]),t._v(" "),n("p",[t._v("Travis官网配置token令牌")]),t._v(" "),n("ul",[n("li",[t._v("在左边的My Repositories加号打开对应的仓库及设置")]),t._v(" "),n("li",[t._v("在Environment Variables中添加自己的token令牌")]),t._v(" "),n("li",[t._v("在.travis.yml配置文件中使用在官网添加的token令牌")]),t._v(" "),n("li",[n("em",[n("strong",[t._v("token名字要跟环境变量github-token配置的一致")])])])]),t._v(" "),n("p",[t._v("开启仓库分支的GitHub page功能")]),t._v(" "),n("ul",[n("li",[t._v("在自己的仓库首页选择setting")]),t._v(" "),n("li",[t._v("在下面有个GitHub Pages")]),t._v(" "),n("li",[t._v("在None选项中选择gh-pages分支 Save一下")]),t._v(" "),n("li",[t._v("页面刷新后回到这个位置会看到有个可以访问的地址(github部署需要时间 需要等一小会)")])]),t._v(" "),n("p",[n("em",[n("strong",[n("a",{attrs:{href:"https://qc-z.github.io/my-components-librarys/",target:"_blank",rel:"noopener noreferrer"}},[t._v("仓库地址"),n("OutboundLink")],1)])])])])}),[],!1,null,null,null);s.default=e.exports}}]);